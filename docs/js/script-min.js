class mensagemErro extends Error{constructor(t){super(t),this.name="Erro"}}document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("telaerro-conteudo"),e=document.getElementById("telaerro"),a=L.map("map").setView([-14.235004,-51.92528],5),o=(t,e)=>t?`${urlBaseJSON}/js/locations/${verPeriudo}/dados-${t}/${e}`:`${urlBaseJSON}/js/locations/${verPeriudo}/dados-algar/${e}`,r=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors',maxZoom:18}),n={OpenStreetMap:r,"Satélite":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'Imagery &copy; <a href="https://www.arcgis.com/" target="_blank">ArcGIS</a>',maxZoom:18}),"Stamen Terrain":L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png",{attribution:'Map tiles by <a href="http://stamen.com" target="_blank">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0" target="_blank">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0" target="_blank">CC BY SA</a>',maxZoom:18}),"Esri World Imagery":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri",maxZoom:18}),"CartoDB Positron":L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"CartoDB Voyager":L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"CartoDB Positron (Sem rótulos)":L.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"CartoDB Voyager (Sem rótulos)":L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/">CartoDB</a> contributors'}),"CartoDB Dark Matter (Sem rótulos)":L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"Esri World Street Map":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri",maxZoom:18}),"Esri World Topo Map":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri",maxZoom:18})},s={},i={},c={};siglasUF.forEach((t=>{s[`locations-${t}pf`]=L.layerGroup(),s[`locations-${t}pj`]=L.layerGroup(),i[`${t} - Pessoa Física <img height="20" width="15" src="./img/marker-icon-green.png"/>`]=s[`locations-${t}pf`],i[`${t} - Pessoa Jurídica <img height="20" width="15" src="./img/marker-icon-black.png"/>`]=s[`locations-${t}pj`],c[`${t}-PF`]=s[`locations-${t}pf`],c[`${t}-PJ`]=s[`locations-${t}pj`]}));const l="oi"!==verOperadora&&"pequenas"!==verOperadora&&"hughes"!==verOperadora&&"starlink"!==verOperadora;if(l||0!=verTudo||u('<h3>A operadora selecionada possui muitos dados a serem exibidos <br> <br>\n\t\tSelecione manualmente os tipos de dados a serem exibidos no menu <img src="./js/leaflet/images/layers.png"/> para exibir os dados</h3>'),1==verTudo)var d=siglasUF.flatMap((t=>[[verDadosPF,`${t}-PF`,()=>h(o(verOperadora,`locations-${t}-PF.json`),`${t}-PF`,"green")],[verDadosPJ,`${t}-PJ`,()=>h(o(verOperadora,`locations-${t}-PJ.json`),`${t}-PJ`,"black")]]));else d=siglasUF.flatMap((t=>[[l,`${t}-PF`,()=>h(o(verOperadora,`locations-${t}-PF.json`),`${t}-PF`,"green")],[!1,`${t}-PJ`,()=>h(o(verOperadora,`locations-${t}-PJ.json`),`${t}-PJ`,"black")]]));function p(t,e){return parseFloat(t)+(Math.random()*e-e/2)}function m(t="none"){e.style.display=t,ocultarTelaLoad()}function u(e){t.innerHTML=e,m("block")}async function g(t){let e=[];try{const a=await fetch(t);if(!a.ok)throw 404===a.status?new Error("A URL não foi encontrada."):new Error("Erro ao carregar dados.");return e.push(!0,a.json()),e}catch(t){return e.push(!1,t),e}}async function h(t,e,a="blue"){try{L.layerGroup();if((await g(t))[0]){const o=L.layerGroup(),r=await g(t);if(r[0]){const t=await r[1];if(t.forEach((function(t){if(null!=t.latitude||null!=t.longitude){const e=L.icon({iconUrl:`./img/marker-icon-${a}.png`,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[0,-41]}),r=L.marker(["pequenas"===verOperadora?p(t.latitude,.05):p(t.latitude,.005),"pequenas"===verOperadora?p(t.longitude,.05):p(t.longitude,.005)],{icon:e});let n="";for(const e of t["info-tecnologia"])n+=` <br>\n\t\t\t\t\t\t\t\t  Tecnologia: ${e.tecnologia} <br>\n\t\t\t\t\t\t\t\t  Tipo de produto: ${e["tipo-de-Produto"]} <br>\n\t\t\t\t\t\t\t\t  Meio de acesso: ${e["meio-de-acesso"]} <br>\n\t\t\t\t\t\t\t\t  Quantidade de acessos: ${e["quantidade-acesso"]} <br>\n\t\t\t\t\t\t\t\t`;markerTexto=`\n\t\t\t\t\t\t\t${t.cidade}, ${t.uf} <br> <br>\n\t\t\t\t\t\t\t${t.empresa} <br>\n\t\t\t\t\t\t\tCNPJ: ${t.cnpj} <br>\n\t\t\t\t\t\t\tTipo de cliente: ${t["pf-ou-pj"]} <br>\n\t\t\t\t\t\t\t${n}\n\t\t\t\t\t\t\t`,r.bindPopup(markerTexto),r.addTo(o)}})),t.length>0){if(!(e in c))throw new mensagemErro(`Tipo de localização desconhecido: ${e}`);c[e].addLayer(o)}}}}catch(t){u(t)}}L.control.layers(n,i).addTo(a),async function(){fetch("./js/locations-data-lista.json").then((t=>{if(!t.ok)throw new Error("Erro ao carregar lista de dados passados.");return t.json()})).then((t=>{const e=document.getElementById("lista-operadora-dados"),a=document.getElementById("lista-data-dados"),o=t[0];if(o["datas-consulta"].forEach(((t,e)=>{const a=new Option(t.periudo,t.valorCampo);document.getElementById("lista-data-dados").appendChild(a)})),o["operadoras-lista"].forEach(((t,e)=>{const a=new Option(t.informacaoExtra?`${t.operadora} - ${t.informacaoExtra}`:`${t.operadora}`,t.valorCampo);document.getElementById("lista-operadora-dados").appendChild(a)})),verOperadora&&(e.value=verOperadora),verPeriudo)a.value=verPeriudo;else{a.options[a.options.length-1].selected=!0}})).catch((t=>{u(t)}))}(),d.forEach((async(t,e)=>{try{await Promise.race([t[2]()]);t[0]&&async function(t){const e=c[t];e?e.addTo(a):u(`Camada não encontrada: ${t}`)}(t[1])}catch(t){u(`Erro ao carregar dados: ${t}`)}})),r.addTo(a),document.getElementById("busca").addEventListener("submit",(function(t){t.preventDefault(),function(){const t=document.getElementById("busca-valor").value;fetch("https://nominatim.openstreetmap.org/search?format=json&q="+t).then((t=>t.json())).then((e=>{if(!(e.length>0)){const e=`https://www.openstreetmap.org/search?query=${encodeURIComponent(t)}`;throw new mensagemErro(`Local não encontrado na base de geolocalização <a href="${e}#map=5/-13.240/-50.383" target="_blank">OpenStreetMap <img src="./img/osm_icon.svg" style="height: 20px;width: 20px;" /></a></b> <br><br>`)}m(),a.setView([parseFloat(e[0].lat),parseFloat(e[0].lon)],14),L.marker([parseFloat(e[0].lat),parseFloat(e[0].lon)]).addTo(a)})).catch((t=>{u(t)}))}()}))}));