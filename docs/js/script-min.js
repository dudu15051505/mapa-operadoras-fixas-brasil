class mensagemErro extends Error{constructor(t){super(t),this.name="Erro"}}document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("telaerro-conteudo"),e=document.getElementById("telaerro"),o=L.map("map").setView([-14.235004,-51.92528],5),a=document.getElementById("load"),r=(document.getElementById("loadImg"),(t,e)=>t?`./js/locations/${t}/${e}`:`./js/locations/tim/${e}`),n=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors',maxZoom:18}),s={OpenStreetMap:n,"Satélite":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'Imagery &copy; <a href="https://www.arcgis.com/" target="_blank">ArcGIS</a>',maxZoom:18}),"Stamen Terrain":L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png",{attribution:'Map tiles by <a href="http://stamen.com" target="_blank">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0" target="_blank">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0" target="_blank">CC BY SA</a>',maxZoom:18}),"Esri World Imagery":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri",maxZoom:18}),"CartoDB Positron":L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"CartoDB Voyager":L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"CartoDB Positron (Sem rótulos)":L.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"CartoDB Voyager (Sem rótulos)":L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/">CartoDB</a> contributors'}),"CartoDB Dark Matter (Sem rótulos)":L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.carto.com/" target="_blank">CartoDB</a> contributors'}),"Esri World Street Map":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri",maxZoom:18}),"Esri World Topo Map":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri",maxZoom:18})},i=["AC","AL","AM","AP","BA","CE","DF","ES","GO","MA","MG","MS","MT","PA","PB","PE","PI","PR","RJ","RN","RO","RR","RS","SC","SE","SP","TO"],c={},l={},p={};for(const t of i)c[`locations-${t}pf`]=L.layerGroup(),c[`locations-${t}pj`]=L.layerGroup(),l[`${t} - Pessoa Física <img height="20" width="15" src="./img/marker-icon-green.png"/>`]=c[`locations-${t}pf`],l[`${t} - Pessoa Jurídica <img height="20" width="15" src="./img/marker-icon-black.png"/>`]=c[`locations-${t}pj`],p[`${t}-PF`]=c[`locations-${t}pf`],p[`${t}-PJ`]=c[`locations-${t}pj`];const d="oi"!==verOperadora,m=i.flatMap((t=>[[d,`${t}-PF`,()=>b(r(verOperadora,`locations-${t}-PF.json`),`${t}-PF`,"green")],[!1,`${t}-PJ`,()=>b(r(verOperadora,`locations-${t}-PJ.json`),`${t}-PJ`,"black")]]));function g(t,e){return parseFloat(t)+(Math.random()*e-e/2)}function h(t="none"){a.style.display=t}function u(t="none"){e.style.display=t,h()}function y(e){t.innerHTML=e,u("block")}async function b(t,e,o="blue"){try{const a=L.layerGroup(),r=await async function(t){try{const e=await fetch(t);if(!e.ok)throw 404===e.status?new Error("A URL não foi encontrada."):new Error("Erro ao carregar dados.");return e.json()}catch(t){y(t)}}(t);if(r.forEach((function(t){if(null!=t.latitude||null!=t.longitude){const e=L.icon({iconUrl:`./img/marker-icon-${o}.png`,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[0,-41]}),r=L.marker([g(t.latitude,.005),g(t.longitude,.005)],{icon:e});markerTexto=`\n\t\t\t\t\t${t.cidade}, ${t.uf} <br> <br>\n\t\t\t\t\t${t.empresa} <br>\n\t\t\t\t\tTipo de cliente: ${t["pf-ou-pj"]} <br>\n\t\t\t\t\tTipo de produto: ${t["tipo-de-Produto"]} <br>\n\t\t\t\t\tMeio de acesso: ${t["meio-de-acesso"]} <br>\n\t\t\t\t\tTecnologia: ${t.tecnologia} <br>\n\n\t\t\t\t\t`,r.bindPopup(markerTexto),r.addTo(a)}})),r.length>0){if(!(e in p))throw new mensagemErro(`Tipo de localização desconhecido: ${e}`);p[e].addLayer(a)}}catch(t){y(t)}}L.control.layers(s,l).addTo(o),async function(){fetch("./js/locations/locations-data-lista.json").then((t=>{if(!t.ok)throw new Error("Erro ao carregar lista de dados passados.");return t.json()})).then((t=>{const e=document.getElementById("lista-data-dados");if(t.forEach(((t,e)=>{const o=new Option(t.informacaoExtra?`${t.operadora} - ${t.informacaoExtra}`:`${t.operadora}`,t.valorCampo);document.getElementById("lista-data-dados").appendChild(o)})),verOperadora)e.value=verOperadora;else{e.options[0].selected=!0}if(document.getElementById(`dados-info-${e.selectedIndex}`)){document.getElementById(`dados-info-${e.selectedIndex}`).style.display="block"}})).catch((t=>{y(t)}))}(),m.forEach((async(t,e)=>{try{await Promise.race([t[2]()]);t[0]&&async function(t){const e=p[t];e?e.addTo(o):y(`Camada não encontrada: ${t}`)}(t[1])}catch(t){y(`Erro ao carregar dados: ${t}`)}})),n.addTo(o),document.getElementById("busca").addEventListener("submit",(function(t){t.preventDefault(),function(){const t=document.getElementById("busca-valor").value;fetch("https://nominatim.openstreetmap.org/search?format=json&q="+t).then((t=>t.json())).then((e=>{if(!(e.length>0)){const e=`https://www.openstreetmap.org/search?query=${encodeURIComponent(t)}`;throw new mensagemErro(`Local não encontrado na base de geolocalização <a href="${e}#map=5/-13.240/-50.383" target="_blank">OpenStreetMap <img src="./img/osm_icon.svg" style="height: 20px;width: 20px;" /></a></b> <br><br>`)}u(),o.setView([parseFloat(e[0].lat),parseFloat(e[0].lon)],10),L.marker([parseFloat(e[0].lat),parseFloat(e[0].lon)]).addTo(o)})).catch((t=>{y(t)}))}()}))}));